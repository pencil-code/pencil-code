===============
Fortran modules
===============
Currently, the Pencil Code contains 541 Fortran files.

Main source files (src)
-----------------------
The *src* directory contains 317 Fortran files.

+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| File                              | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
+===================================+================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| ``ascalar``                       | This module is used to solve the equation of supersaturation for either the Smoluchowski approach or the swarm model.                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``bfield``                        | This module directly evolves the magnetic field instead of the vector potential; special care needs to be taken to guarantee the divergence of the field remains zero.                                                                                                                                                                                                                                                                                         |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``border_profiles``               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``boundcond``                     | Module for boundary conditions. Extracted from (no)mpicomm, since all non-periodic (external) boundary conditions require the same code for serial and parallel runs.                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``boundcond_alt``                 | Module for boundary conditions. Extracted from (no)mpicomm, since all non-periodic (external) boundary conditions require the same code for serial and parallel runs.                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``cdata``                         | Global variables are defined in this module.                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``chemistry``                     | This modules adds chemical species and reactions. The units used in the chem.in files are cm3,mole,sec,kcal and K                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``chemistry_simple``              | This modules addes chemical species and reactions. The units used in the chem.in files are cm3,mole,sec,kcal and K This was found out by comparing the mechanism found in samples/0D/chemistry\_H2\_ignition\_delay with Flow Reactor Studies and Kinetic Modeling of the ReactionH/O22 of  A. MUELLER, T. J. KIM, R. A. YETTER, F. L. DRYER                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``chiral``                        | This modules solves two reactive scalar advection equations This is used for modeling the spatial evolution of left and right handed aminoacids.                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``combine_videofiles``            | Not a module                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``cosmicray``                     | This modules solves the cosmic ray energy density equation. It follows the description of Hanasz & Lesch (2002,2003) as used in their ZEUS 3D implementation.                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``cosmicray_nolog``               | This modules solves the cosmic ray energy density equation. It follows the description of Hanasz & Lesch (2002,2003) as used in their ZEUS 3D implementation.                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``cosmicrayflux``                 | Module for calculating Cosmic Ray Flux.                                                                                                                                                                                                                                                                                                                                                                                                                        |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``cparam``                        | Module containing global parameters (constants).                                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``debug_io_dist``                 | Distributed debug-IO (i.e. each process writes its own file data/procX)                                                                                                                                                                                                                                                                                                                                                                                        |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``debug_io_hdf5``                 | HDF5 debug-IO module                                                                                                                                                                                                                                                                                                                                                                                                                                           |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``debug_io_mpi``                  | Parallel debug-IO via MPI2 (i.e. write to a single file in data/allprocs)                                                                                                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``density``                       | This module takes care of the continuity equation.                                                                                                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``density_bcs``                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``density_methods``               | 11-mar-15/MR:  Created to avoid circular dependencies with EquationOfState.                                                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``density_stratified``            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``density_stratified_methods``    | Dummy module for density\_stratified, with which all density queries should be done in EquationOfState.                                                                                                                                                                                                                                                                                                                                                        |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``deriv``                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``deriv_10th``                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``deriv_2nd``                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``deriv_2nd_all``                 | This module is a copy of the 'deriv\_2nd' module, but implements all derivatives, including up to 6th order, with 2nd order accuracy. In 'deriv\_2nd' the 3rd or higher derivatives are otherwise unavailable. To provide higher derivatives in this module, nghost must be 3.                                                                                                                                                                                 |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``deriv_4th``                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``deriv_4th_all``                 | This module is a copy of the 'deriv\_4th' module, but implements all derivatives, including up to 6th order, with 4th order accuracy. In 'deriv\_4th' the 5th or higher derivatives are otherwise unavailable. To provide higher derivatives in this module, nghost must be 4.                                                                                                                                                                                 |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``deriv_8th``                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``deriv_alt``                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``detonate``                      | This module searches for gravitationally collapsing sites and detonates them.                                                                                                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``diagnostics``                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``diagnostics_outlog``            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``dustdensity``                   | This module takes care of everything related to dust density.                                                                                                                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``dustvelocity``                  | This module takes care of everything related to dust velocity                                                                                                                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``emulated``                      | Module emulating not universally available intrinsics                                                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``entropy``                       | This module takes care of evolving the entropy.                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``entropy_bcs``                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``entropy_const``                 | This module is for systems with spatially fixed entropy distribution. This implies Ds/Dt=u.grads only, which is used in Ds/Dt=(1/gamma)*Dlnp/Dt-Dlnrho/Dt, for example. This procedure has been used in the context of accretion discs (see von Rekowski et al., 2003, A&A 398, 825). The shock jump relations are modified (see Sect 9.3.6 of Brandenburg 2003, in "Computational aspects...", ed. Ferriz-Mas & Nunez, Taylor & Francis, or astro-ph/0109497. |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``entropy_onefluid``              | This module takes care of entropy (initial condition and time advance) for a fluid consisting of gas and perfectly coupled pressureless dust.                                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``eos_chemistry``                 | Equation of state for an ideal gas without ionization.                                                                                                                                                                                                                                                                                                                                                                                                         |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``eos_chemistry_simple``          | Equation of state for an ideal gas without ionization.                                                                                                                                                                                                                                                                                                                                                                                                         |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``eos_fixed_ionization``          | Thermodynamics with Fixed ionization fraction                                                                                                                                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``eos_idealgas``                  | Equation of state for an ideal gas without ionization.                                                                                                                                                                                                                                                                                                                                                                                                         |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``eos_ionization``                | This modules contains the routines for simulation with simple hydrogen ionization.                                                                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``eos_temperature_ionization``    | Routine for ideal gas with variable degree of ionization and hence variable mean molecular weight. Here, the ionization fraction, yH, is allocated as an additional auxiliary array in f.                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``equ``                           | subroutines in the chosen set of physics modules.                                                                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``farray``                        | This module allocates and manages indices in the f-array in a controlled way.  This includes handling different types of variable that may be stored in the f-array like PDE variables, auxiliaries, communicated auxiliaries and global variables.                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``farray_alloc``                  | Dynamical allocation of f and df.                                                                                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``fft_nr``                        | Not a module                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``fftpack``                       | Not a module                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``file_io_common``                | This module holds only common standard code for all File-IO modules. It is NOT meant to be used as a replacement for the other File-IO modules!                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``file_io_dist``                  | This module goes straight and implements distributed file Input/Output. We use here only F95 features and are explicitly not HPC-friendly.                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``file_io_f2003``                 | This module goes straight and implements distributed file Input/Output. We use here only F2003 features (HPC-friendly).                                                                                                                                                                                                                                                                                                                                        |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``file_io_f95``                   | This module takes care of massive parallel file Input/Output. We use here only F95 features for HPC-friendly behaviour.                                                                                                                                                                                                                                                                                                                                        |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``filter``                        | Filters for smoothing, removing trends (like spurious build-up of horizontal momentum) and similar.                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``fixed_point``                   | Find the fixed points of a field line mapping. Field line mappings are maps of F(x,y) through field lines which trace point at z = z0 to z = z1. Fixed points are such that F(x,y) = (x,y)                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``forcing``                       | This module contains routines both for delta-correlated and continuous forcing. The fcont pencil is only provided for continuous forcing.                                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``fourier_fft``                   | This module contains FFT wrapper subroutines.                                                                                                                                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``fourier_fftpack``               | This module contains FFT wrapper subroutines.                                                                                                                                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``general``                       | Module with general utility subroutines.                                                                                                                                                                                                                                                                                                                                                                                                                       |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``geometrical_types``             | Collection of geometrical object types. (Presently only rectangular toroid)                                                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``ghost_check``                   | This module tests the ghost zones consistency. For more documentation about the ghost zones, please refer to Mpicomm.f90.                                                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``ghostfold_mpicomm``             | This module folds ghost zones for a multiple processor run.                                                                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``ghostfold_nompicomm``           | This module folds ghost zones for a single processor run.                                                                                                                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``gpu_astaroth``                  | This module contains GPU related types and functions to be used with the ASTAROTH nucleus.                                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``gravity_r``                     | Radial gravity                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``gravity_simple``                | This module takes care of simple types of gravity, i.e. where gx=gx(x) or gy=gy(y) or gz=gz(z) Here the gravity master pencils gravx\_xpencil, gravy\_ypencil and gravz\_zpencil only need to be calculated once, and then these can simply be added to the equations of motion again and again.                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``grid``                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``hdf5_io_parallel``              | This module takes care of massive parallel HDF5 file Input/Output. We use here only F95 and MPI features for HPC-friendly behaviour.                                                                                                                                                                                                                                                                                                                           |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``heatflux``                      | This module computes the time depentend heat flux equation. The non-Fourier form is written tau * dq/dt + q  = F(T,rho ...) The analytical solution for constant F is that q converges exponential to F with a time scale of tau.                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``hydro``                         | This module takes care of most of the things related to velocity. Pressure, for example, is added in the energy (entropy) module.                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``hydro_kinematic``               | This module supplies a kinematic velocity field. Most of the content of this module was moved with revision r12019 by Dhrubaditya Mitra on 5-nov-09 away from nohydro.f90 To inspect the revision history of the file before that time, check out nohydro.f90 prior to or at revision r12018.                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``hydro_potential``               | This module takes care of most of the things related to velocity. Pressure, for example, is added in the energy (entropy) module.                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``hyperresi_strict_2nd``          | This module applies a sixth order hyperresistivity to the induction equation (following Brandenburg & Sarson 2002). This hyperresistivity ensures that the energy dissipation rate is positive define everywhere.                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``hypervisc_strict_2nd``          | This module applies a sixth order hyperviscosity to the equation of motion (following Haugen & Brandenburg 2004). This hyperviscosity ensures that the energy dissipation rate is positive define everywhere.                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``hypervisc_strict_fft``          | This module applies a sixth order hyperviscosity to the equation of motion (following Haugen & Brandenburg 2004). This hyperviscosity ensures that the energy dissipation rate is positive define everywhere.                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``implicit_diffusion``            | This module provides general facilities to implicitly solve a diffusion equation.                                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``implicit_physics``              | This module solves the radiative diffusion implicitly thanks to an Alternate Direction Implicit Scheme (ADI) in a D'Yakonov form lambda\_x T(n+1/2) = lambda\_x + lambda\_z lambda\_z T(n+1) = T(n+1/2)                                                                                                                                                                                                                                                        |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``initcond``                      | This module contains code used by the corresponding physics modules to set up various initial conditions (stratitication, perturbations, and other structures). This module is not used during run time (although it is used by the physics modules that are used both during run time and for the initial condition).                                                                                                                                         |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``interstellar``                  | This modules contains the routines for SNe-driven ISM simulations. Replaces old module relabelled as interstellar\_old Jul 15 FAG.                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``interstellar_old``              | This modules contains the old routines for SNe-driven ISM simulations. It may be necessary to select this for using old simulation data                                                                                                                                                                                                                                                                                                                        |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``io_collect``                    | I/O via MPI root rank by collecting data from all processors. (storing data into one file, e.g. data/allprocs/var.dat)                                                                                                                                                                                                                                                                                                                                         |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``io_collect_xy``                 | I/O via MPI by collecting data from all processors in the xy-plane. (storing data into files, e.g. data/proc(0,7,15,...)/var.dat)                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``io_collect_xy_f2003``           | I/O via MPI by collecting data from all processors in the xy-plane. (storing data into files, e.g. data/proc(0,7,15,...)/var.dat)                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``io_dist``                       | Distributed IO (i.e. each process writes its own file data/procX)                                                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``io_dist_outlog``                | Distributed IO (i.e. each process writes its own file data/procX)                                                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``io_hdf5``                       | I/O via the HDF5 hyperslab-by-chunk IO routines. (storing data into one file, e.g. data/allprocs/VAR#.h5)                                                                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``io_mpi2``                       | I/O via the MPI v2 standard IO routines. (storing data into one file, e.g. data/allprocs/var.dat)                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``io_wrapper``                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``lorenz_gauge``                  | Lorenz gauge, dphi/dt = -cphi2*divA, with possibility to add diffusion and advection terms. The difficulty is that first derivatives are applied twice during one loop in the calculation of gauge waves. This leads to wiggles that are difficult to damp.                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``lsode_for_chemistry``           | Specific module only used by timestep\_LSODE if chemistry is solved with the implicit solver LSODE for stiff ODEs.                                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``magnetic``                      | This modules deals with all aspects of magnetic fields; if no magnetic fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the magnetically relevant subroutines listed in here.                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``messages``                      | This module takes care of code messages.                                                                                                                                                                                                                                                                                                                                                                                                                       |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``mpicomm``                       | This module takes care of MPI communication.                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``neutraldensity``                | This module is used both for the initial condition and during run time. It contains dlnrhon\_dt and init\_lnrhon, among other auxiliary routines.                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``neutralvelocity``               | This module takes care of everything related to velocity                                                                                                                                                                                                                                                                                                                                                                                                       |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noascalar``                     | This modules solves the passive scalar advection equation.                                                                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noborder_profiles``             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noboundcond``                   | Module for boundary conditions. Extracted from (no)mpicomm, since all non-periodic (external) boundary conditions require the same code for serial and parallel runs.                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nochemistry``                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nochiral``                      | This modules solves two reactive scalar advection equations This is used for modeling the spatial evolution of left and right handed aminoacids.                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nocosmicray``                   | This modules solves the passive scalar advection equation                                                                                                                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nocosmicrayflux``               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nodebug``                       | Not a module                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nodensity``                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nodensity_bcs``                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nodensity_methods``             | 11-mar-15/MR:  Created to avoid circular dependencies with EquationOfState.                                                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noderiv``                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nodetonate``                    | This module is dummy.                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nodustdensity``                 | This module takes care of everything related to dust density.                                                                                                                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nodustvelocity``                | This module takes care of everything related to dust velocity.                                                                                                                                                                                                                                                                                                                                                                                                 |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noenergy``                      | Dummy module for energy equation.                                                                                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noenergy_bcs``                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noentropy``                     | Calculates pressure gradient term for polytropic equation of state $p=\text{const}\rho^{\Gamma}$.                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noeos``                         | This module takes care of everything related to equation of state.                                                                                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nofarray_alloc``                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nofixed_point``                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noforcing``                     | This module contains routines both for delta-correlated and continuous forcing. The fcont pencil is only provided for continuous forcing.                                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nofourier``                     | This module contains FFT wrapper subroutines.                                                                                                                                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noghostfold``                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nogpu``                         | This module contains GPU related dummy types and functions.                                                                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nogravity``                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nogrid``                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nohdf5_io``                     | This module is a dummy module for non-HDF5 IO. 28-Oct-2016/PABoudin: coded                                                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noheatflux``                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nohydro``                       | no variable $\uv$: useful for kinematic dynamo runs.                                                                                                                                                                                                                                                                                                                                                                                                           |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nohyperresi_strict``            | This module applies a sixth order hyperresistivity to the induction equation (following Brandenburg & Sarson 2002). This hyperresistivity ensures that the energy dissipation rate is positive define everywhere.                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nohypervisc_strict``            | This module applies a sixth order hyperviscosity to the equation of motion (following Haugen & Brandenburg 2004).                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noimplicit_diffusion``          | Dummy                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noimplicit_physics``            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noinitial_condition``           | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nointerstellar``                | Dummy module.                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nolorenz_gauge``                | Lorenz gauge, dphi/dt = -cphi2*divA                                                                                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nolsode_for_chemistry``         | This module calculates the chemistry contribution to df in the case where chemistry is solved separately using the LSODE solver                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nomagnetic``                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nompicomm``                     | Dummy module for MPI communication. This allows the code to run on a single CPU.                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noneutraldensity``              | This module is used both for the initial condition and during run time. It contains dlnrhon\_dt and init\_lnrhon, among other auxiliary routines.                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noneutralvelocity``             | This module takes care of everything related to neutral velocity                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noNSCBC``                       | Module for NSCBC boundary conditions. To be included from boundcond.f90.                                                                                                                                                                                                                                                                                                                                                                                       |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noopacity``                     | This module is the dummy for the opacity module(s).                                                                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles``                   | This module takes care of everything related to dust particles.                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_adaptation``        | This modules takes care of adapting the number of particles in a grid cell to a desired value. This module is based on an original idea by Jacob Trier Frederiksen.                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_adsorbed``          | This module takes care of everything related to particle surface fractions.                                                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_caustics``          | This module writes information about the local state of the gas at the positions of a selected number of particles.                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_chemistry``         | This module takes care of everything related to particle chemistry                                                                                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_coagulation``       | This modules takes care of instantaneous coagulation, shattering, erosion, and bouncing of superparticles.                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_collisions``        | This modules takes care of instantaneous collisions between superparticles.                                                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_condensation``      | This modules takes care of condensation / evaporation or deposition / sublimation of superparticles                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_density``           | This module takes care of everything related to the density represented by each (super)particle.                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_diagnos_dv``        | This modules takes care of instantaneous collisions between superparticles.                                                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_diagnos_state``     | This modules takes care of instantaneous collisions between superparticles.                                                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_drag``              | This module takes care of drag forces between particles and gas.                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_grad``              | This module tries to solve for gradient matrix of particle velocities                                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_kmeans``            | Dummy version of k-means vector quantization algorithm using the Forgy initialisation of the codebook.                                                                                                                                                                                                                                                                                                                                                         |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_lyapunov``          | This module writes information about the local state of the gas at the positions of a selected number of particles.                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_main``              | This module contains all the main structure needed for particles.                                                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_map``               | This module contains subroutines for mapping particles on the mesh.                                                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_mass``              | This module takes care of everything related to the mass of the particles.                                                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_mpicomm``           | This module deals with communication of particles between processors.                                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_number``            | This module takes care of everything related to particle number.                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_persistence``       | This module calculates the probability distribution function the particles that have moved a certain distance away from their initial position.                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_potential``         | The no module for particles potential                                                                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_radius``            | This module takes care of everything related to particle radius.                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_selfgravity``       | This module takes care of everything related to particle self-gravity.                                                                                                                                                                                                                                                                                                                                                                                         |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_sink``              | This module takes care of everything related to sink particles.                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_spin``              | This module takes care of everything related to particle spin.                                                                                                                                                                                                                                                                                                                                                                                                 |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_stalker``           | This module writes information about the local state of the gas at the positions of a selected number of particles.                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_stirring``          | This module takes care of stirring of particles.                                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_sub``               | This module contains subroutines useful for the Particle module.                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_surfspec``          | This module takes care of everything related to particle surface fractions.                                                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_temperature``       | This module takes care of everything related to particle temperature.                                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noparticles_tetrad``            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nopointmasses``                 | This module takes care of direct N-body gravity between point masses.                                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nopoisson``                     | This module solves the Poisson equation.                                                                                                                                                                                                                                                                                                                                                                                                                       |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nopolymer``                     | This modules deals with all aspects of polymers.                                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nopower_spectrum``              | reads in full snapshot and calculates power spetrum of u                                                                                                                                                                                                                                                                                                                                                                                                       |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nopscalar``                     | This modules solves the passive scalar advection equation.                                                                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nopython``                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noradiation``                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noselfgravity``                 | This module takes care of self gravity.                                                                                                                                                                                                                                                                                                                                                                                                                        |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noSGS_hydro``                   | This module is the dummy for the SGS\_hydro module in which e.g the SGS viscous force or viscous heat is computed.                                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noshear``                       | This modules deals with all aspects of shear; if no shear is invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the shear relevant subroutines listed in here.                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noshock``                       | This module calculates a divergence of u based shock finding profile used by shock viscosities and diffusion terms. eg. the total voscosity is taken as: nu\_total = nu + nu\_shock*dx*smooth(max5(-(div u)))) where dx*smooth(max5(-(div u)))) is the profile calculated here in.                                                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nosignal_handling``             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noslices``                      | This module produces slices for animation purposes.                                                                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nosolid_cells``                 | This module add solid (as in no-fluid) cells in the domain. This can be used e.g. in order to simulate a cylinder in a cross flow.                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nosolid_cells_mpicomm``         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nosolid_cells_ogrid_cdata``     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nosolid_cells_ogrid_chemistry`` |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nosolid_cells_ogrid_sub``       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nospecial``                     | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                                         |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nostreamlines``                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nostruct_func``                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``notestfield``                   | This modules deals with all aspects of testfield fields; if no testfield fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testfield relevant subroutines listed in here.                                                                                                                                                                                                                       |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``notestflow``                    | This modules deals with all aspects of testfield fields; if no testfield fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testfield relevant subroutines listed in here.                                                                                                                                                                                                                       |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``notestperturb``                 | test perturbation method                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``notestscalar``                  | This modules deals with all aspects of testscalar fields; if no testscalar fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testscalar relevant subroutines listed in here.                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``notimeavg``                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``notraining``                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noviscosity``                   | This module is the dummy for the viscosity module in which e.g the viscous force or viscous heat is computed.                                                                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noweno_transport``              | This module take care of WENO (weighted essentially non oscillatory) transport.                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noyinyang``                     | This module contains Yin-Yang related dummy types and functions.                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noyinyang_mpi``                 | This module contains Yin-Yang related dummy types and functions.                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``NSCBC``                         | Module for NSCBC (Navier-Stokes Characteristic Boundary Conditions). NSCBC is an alternative way of imposing (time-dependent) boundary conditions through solving differential equations on the boundaries.                                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``param_io``                      | IO of init and run parameters. Subroutines here are 'at the end of the food chain', i.e. depend on all physics modules plus possibly others. Using this module is also a compact way of referring to all physics modules at once.                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_adaptation``          | This modules takes care of adapting the number of particles in a grid cell to a desired value. This module is based on an original idea by Jacob Trier Frederiksen and was developed by Anders Johansen and Chao-Chin Yang.                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_adsorbed``            | This module takes care of the evolution of adsorbed species on the particle surface for reactive particles                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_caustics``            | This modules solves for the gradient matrix of flow velocities. The gradient matrix Sigma obeys the equation: (d/dt) Sigma = (1/(taup))*(S - Sigma) - Sigma^2 where A is the flow gradient matrix at the position of the particle; and taup is the Stokes time.                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_cdata``               | Global particle variables                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_charged``             | This module takes care of everything related to inertial particles.                                                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_chemistry``           | This module implements reactive particles.                                                                                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_coagulation``         | This modules takes care of instantaneous coagulation, shattering, erosion, and bouncing of superparticles.                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_collisions``          | This modules takes care of instantaneous collisions between superparticles.                                                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_density``             | This module takes care of everything related to the density represented by each (super)particle.                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_diagnos_dv``          | This module bins particle pairs in separation and relative velocity at regular intervals.                                                                                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_diagnos_state``       | This module tracks the evolution of particles in terms of user defined "states".  Currently the only implemented state is in terms of the local gas velocity.                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_drag``                | This module integrates drag forces between particles and gas.                                                                                                                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_dust``                | This module takes care of everything related to inertial particles.                                                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_dust_blocks``         | This module takes care of everything related to dust particles.                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_eikonal``             | Eikonal solver, "particles" refer here to points on the trajectory.                                                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_grad``                | This module tries to solve for gradient matrix of particle velocities                                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_lagrangian``          | This module takes care of everything related to inertial particles.                                                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_lyapunov``            | This module writes information about the local state of the gas at the positions of a selected number of particles.                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_main``                | This module contains all the main structure needed for particles.                                                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_map``                 | This module contains subroutines for mapping particles on the mesh. Different domain decompositions have different versions of this module.                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_map_blocks``          | This module contains subroutines useful for mapping particles on the mesh.                                                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_map_index``           | This module contains subroutines for particle-mesh related operations.                                                                                                                                                                                                                                                                                                                                                                                         |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_mass``                | This module takes care of everything related to the mass of the particles.                                                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_mass_swarm``          | This module handles the mass of super-particles.                                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_mpicomm``             | This module deals with communication of particles between processors.                                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_mpicomm_blocks``      | This module deals with communication of particles between processors.                                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_number``              | This module takes care of everything related to internal particle number.                                                                                                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_persistence``         | This module calculates the probability distribution function the particles that have moved a certain distance away from their initial position.                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_potential``           | This module takes care of everything related to pairwise interaction of particles. It is experimental now (April 2016)                                                                                                                                                                                                                                                                                                                                         |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_radius``              | This module takes care of everything related to particle radius.                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_selfgravity``         | This module takes care of everything related to particle self-gravity by inverting the Poisson equation of the particle density mapped on the grid.                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_sink``                | This module takes care of everything related to sink particles.                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_spin``                | This module takes care of everything related to particle spin including lifting forces. The module maintains a full f-array vorticity field, to be able to interpolate on the flow vorticity.                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_stalker``             | This module writes information about the local state of the gas at the positions of a selected number of particles.                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_stirring``            | This module takes care of stirring of particles.                                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_sub``                 | This module contains useful subroutines for the particle modules. Subroutines that depend on domain decomposition should be put in the Particles\_map module.                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_surfspec``            | This module takes care the gas phase species in the immediate vicinity of reactive particles.                                                                                                                                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_temperature``         | This module takes care of everything related to inertial particles.                                                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_tetrad``              | Follow a particle. For this particle solve for three other particles that that are in the neighbourhood of the particle we were following. These four particles together forms a tetrad.                                                                                                                                                                                                                                                                       |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_tracers``             | This module takes care of everything related to tracer particles.                                                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``pencil_check``                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``pencil_emul``                   | Not a module                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``persist``                       | Module to handle variables whose state should persist between executions of run.x, e.g. the random number seeds and some other forcing state information.                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``pointmasses``                   | This module takes care of direct N-body gravity between point masses.                                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``poisson``                       | This module solves the Poisson equation (d^2/dx^2 + d^2/dy^2 + d^2/dz^2 - h) f = RHS(x,y,z) [which for h/=0 could also be called inhomogenous nonuniform Helmholtz equation] for the function f(x,y,z).                                                                                                                                                                                                                                                        |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``poisson_logspirals``            | This module contains (more or less) a replica of poisson.f90, implementing the version of poisson equation solving that I have been building (the method outlined in Clement Baruteau's thesis).                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``poisson_multigrid``             | This module solves the Poisson equation (d^2/dx^2 + d^2/dy^2 + d^2/dz^2 - h) f = RHS(x,y,z) [which for h/=0 could also be called inhomogenous nonuniform Helmholtz equation] for the function f(x,y,z), starting from the second-order accurate 7-point discretization of that equation.                                                                                                                                                                       |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``polymer``                       | This modules deals with all aspects of polymers.                                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``polynomialroots``               | PURPOSE - Solve for the roots of a polynomial equation with real coefficients, up to quartic order. Returns a code indicating the nature of the roots found.                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``power_spectrum``                | reads in full snapshot and calculates power spetrum of u                                                                                                                                                                                                                                                                                                                                                                                                       |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``pscalar``                       | This modules solves the passive scalar advection equation.                                                                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``pscalar_nolog``                 | This modules solves (multiple) passive scalar advection equation(s) Solves for c, not ln(c).                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``python``                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``radiation_ray``                 | Radiation (solves transfer equation along rays).                                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``read_all_videofiles``           | Not a module                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``read_vectorfiles``              | Not a module                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``read_videofiles``               | Not a module                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``register``                      | A module for setting up the f-array and related variables ('register' the velocity, energy, magnetic, etc modules).                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``run``                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``selfgravity``                   | This module takes care of self gravity by solving the Poisson equation (d^2/dx^2 + d^2/dy^2 + d^2/dz^2)phi = 4*pi*G*rho for the potential phi.                                                                                                                                                                                                                                                                                                                 |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``selfgravity_logspirals``        | This module takes care of self gravity by solving the Poisson equation (d^2/dx^2 + d^2/dy^2 + d^2/dz^2)phi = 4*pi*G*rho for the potential phi.                                                                                                                                                                                                                                                                                                                 |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``SGS_hydro``                     | This module is the dummy for the SGS\_hydro module in which e.g the SGS force or heat is computed.                                                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``shared_variables``              | This module is an interface to allow modules to register pointers to their internal variables so that other modules may then request them by name.                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``shear``                         | This modules deals with all aspects of shear; if no shear is invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the shear relevant subroutines listed in here.                                                                                                                                                                                                                                                  |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``shock``                         | This modules implements viscous heating and diffusion terms here for shock viscosity nu\_total = nu + nu\_shock*dx^2*smooth(max5(-(div u))))                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``shock_highorder``               | This modules implements viscous heating and diffusion terms here for shock viscosity nu\_total = nu + nu\_shock*dx^2*smooth(max5(-(div u))))                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``signal_handling``               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``slices``                        | This module produces slices for animation purposes.                                                                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``slices_methods``                | This module provides routines for obtaining slice data.                                                                                                                                                                                                                                                                                                                                                                                                        |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``snapshot``                      | Write snapshot files (variables and power spectra).                                                                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``solid_cells``                   | This module add solid (as in no-fluid) cells in the domain. This can be used e.g. in order to simulate a cylinder in a cross flow.                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``solid_cells_ogrid``             | This module add solid (as in no-fluid) cells in the domain. This can be used e.g. in order to simulate a cylinder in a cross flow.                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``solid_cells_ogrid_cdata``       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``solid_cells_ogrid_chemistry``   | This modules addes chemical species and reactions. The units used in the chem.in files are cm3,mole,sec,kcal and K This was found out by comparing the mechanism found in samples/0D/chemistry\_H2\_ignition\_delay with Flow Reactor Studies and Kinetic Modeling of the ReactionH/O22 of  A. MUELLER, T. J. KIM, R. A. YETTER, F. L. DRYER                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``solid_cells_ogrid_mpicomm``     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``solid_cells_ogrid_nompicomm``   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``solid_cells_ogrid_sub``         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``special``                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``start``                         | Not a module                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``streamlines``                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``struct_func``                   | Calculates 2-point structure functions and/or PDFs and saves them during the run.                                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``sub``                           | This module contains useful subroutines.                                                                                                                                                                                                                                                                                                                                                                                                                       |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``syscalls``                      | This module takes care of system calls and provides ANSI-C functionality.                                                                                                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``temperature_bcs``               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``temperature_idealgas``          | This module can replace the energy module by using lnT or T (with ltemperature\_nolog=.true.) as dependent variable. For a perfect gas with constant coefficients (no ionization) we have: (1-1/gamma) * cp*T = cs20 * exp( (gamma-1)*ln(rho/rho0)-gamma*s/cp )                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``temperature_ionization``        | This module can replace the energy module by using lnT or T (with ltemperature\_nolog=.true.) as dependent variable.                                                                                                                                                                                                                                                                                                                                           |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testfield_axisym``              | Test-field module for axisymmetric turbulence. No special settings in cparam.local are needed.                                                                                                                                                                                                                                                                                                                                                                 |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testfield_axisym2``             | Test-field module for axisymmetric turbulence. No special settings in cparam.local are needed.                                                                                                                                                                                                                                                                                                                                                                 |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testfield_meri``                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testflow_z``                    | This modules deals with all aspects of testflow fields; if no testflow fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testflow relevant subroutines listed in here.                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``thermal_energy``                | This module can replace the energy module by using the thermal energy eth as dependent variable. For a perfect gas we have                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timeavg``                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep``                      | Runge-Kutta time advance, accurate to order itorder. At the moment, itorder can be 1, 2, or 3.                                                                                                                                                                                                                                                                                                                                                                 |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep_LSODE``                | Timestepping routine corresponding to the use of LSODE to solve chemistry. The transport equations are solved as usual using RK methods but the chemistry ODEs are separated and solved implicitly using LSODE either following a sequential (1 chemistry step) or symmetric (2 chemistry steps) splitting scheme.                                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep_RKC-10``               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep_RKC-20``               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep_RKC-25``               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep_RKC-40``               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep_rkf``                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep_rkf_1d``               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep_rkf_lowsto``           | Runge-Kutta-Fehlberg Low-Storage method Christopher A. Kennedy, Mark H. Carpenter, R.Michael Lewis, Low-storage, explicit Runge–Kutta schemes for the compressible Navier–Stokes equations, Applied Numerical Mathematics, Volume 35, Issue 3, 2000, Pages 177-219, ISSN 0168-9274, https://doi.org/10.1016/S0168-9274(99)00141-5.                                                                                                                             |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep_stiff``                | adapted from timestep\_rkf, and from numerical recipe stiff algorithm                                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep_strang``               | Runge-Kutta time advance, accurate to order itorder. At the moment, itorder can be 1, 2, or 3.                                                                                                                                                                                                                                                                                                                                                                 |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep_sts``                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep_subcycle``             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``training_torchfort``            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``viscosity``                     | This modules implements viscous heating and diffusion terms here for cases 1) nu constant, 2) mu = rho.nu 3) constant and                                                                                                                                                                                                                                                                                                                                      |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``weno_transport``                | This module take care of WENO (weighted essentially non oscillatory) transport.                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``write_default_namelists``       | Not a module                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``yinyang``                       | This module contains Yin-Yang related types and functions which are incompatible with FORTRAN 95.                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``yinyang_mpi``                   | This module contains Yin-Yang related types and functions which are incompatible with FORTRAN 95.                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

*experimental* source files (src/experimental)
----------------------------------------------
The *src/experimental* directory contains 41 Fortran files.

+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| File                                   | Description                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+========================================+=========================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| ``analyzers``                          | use EMD, only: analyzer\_emd                                                                                                                                                                                                                                                                                                                                                                                                                            |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``anelastic``                          | This module solves the Poisson equation for pressure for the linearized density                                                                                                                                                                                                                                                                                                                                                                         |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``barneshut``                          | This module implements gas/dust self-gravity using a Barnes-Hut octree algorithm. The main function, do\_barneshut, takes the variable 'phi' as input, which is the gas/dust density grid from the selfgravity module, and modifies 'phi' in place, becoming the gravitational potential.                                                                                                                                                               |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``boussinesq``                         | 23-mar-2012/dintrans: coded                                                                                                                                                                                                                                                                                                                                                                                                                             |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``conductivity``                       | This module takes care of heat conductivity for the energy equation.                                                                                                                                                                                                                                                                                                                                                                                    |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``cosmicray_current``                  | Module for calculating Cosmic Ray Flux.                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``cosmicray_density``                  | This modules solves the cosmic ray energy density equation. It follows the description of Hanasz & Lesch (2002,2003) as used in their ZEUS 3D implementation.                                                                                                                                                                                                                                                                                           |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``emd``                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``entropy_anelastic``                  | This module takes care of energy (initial condition and time advance)                                                                                                                                                                                                                                                                                                                                                                                   |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``eos_idealgas_vapor``                 | Equation of state for an ideal gas with variable water vapour.                                                                                                                                                                                                                                                                                                                                                                                          |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``file_io_f2003``                      | This module takes care of massive parallel file Input/Output. We use here F2003 features for HPC-friendly behaviour.                                                                                                                                                                                                                                                                                                                                    |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``forcing_cont_sample``                | This module contains routines both for delta-correlated and continuous forcing. The fcont pencil is only provided for continuous forcing.                                                                                                                                                                                                                                                                                                               |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``gravity_r_radpressure``              | Radial gravity                                                                                                                                                                                                                                                                                                                                                                                                                                          |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``hydro_ffreeMHDrel``                  | This module solve the momentum equation for relativistic force-free MHD dS/dt = curlB x B +  curlE x E + divE E where E = (BxS)/B^2                                                                                                                                                                                                                                                                                                                     |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``magnetic_ffreeMHDrel``               | Relativistic treatment of force-free magnetic fields. Still quite experimental. This modules deals with all aspects of magnetic fields; if no magnetic fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the magnetically relevant subroutines listed in here.                                                                                                                               |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``magnetic_shearboxJ``                 | This modules deals with all aspects of magnetic fields; if no magnetic fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the magnetically relevant subroutines listed in here.                                                                                                                                                                                                               |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``mpicomm``                            | This module takes care of MPI communication.                                                                                                                                                                                                                                                                                                                                                                                                            |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``neutralvelocity_matchiontemp``       | This module takes care of everything related to velocity                                                                                                                                                                                                                                                                                                                                                                                                |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``noconductivity``                     | Dummy module for conductivity.                                                                                                                                                                                                                                                                                                                                                                                                                          |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nompicomm``                          | Dummy module for MPI communication. This allows the code to run on a single CPU.                                                                                                                                                                                                                                                                                                                                                                        |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_dust_ajwr``                | This module takes care of everything related to inertial particles.                                                                                                                                                                                                                                                                                                                                                                                     |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_dust_brdeplete``           | This module takes care of everything related to inertial particles.                                                                                                                                                                                                                                                                                                                                                                                     |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_mpicomm_blocks_partition`` | This module deals with communication of particles between processors.                                                                                                                                                                                                                                                                                                                                                                                   |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_nbody_ajwr``               | This module takes care of direct N-body gravity between particles.                                                                                                                                                                                                                                                                                                                                                                                      |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_potential``                | This module takes care of everything related to pairwise interaction of particles. It is experimental now (April 2016)                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_radius_ajwr``              | This module takes care of everything related to particle radius.                                                                                                                                                                                                                                                                                                                                                                                        |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_radius_strubbechiang``     | This module takes care of everything related to particle radius.                                                                                                                                                                                                                                                                                                                                                                                        |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``pc_h5collect``                       | Not a module                                                                                                                                                                                                                                                                                                                                                                                                                                            |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``poisson_cyl``                        | This module solves the Poisson equation in cylindrical coordinates (d^2/dr^2 +1/r*d/dr + 1/r^2*d^2/dy^2 + d^2/dz^2) f = RHS(x,y,z)                                                                                                                                                                                                                                                                                                                      |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``poisson_expand``                     | This module solves the Poisson equation (d^2/dx^2 + d^2/dy^2 + d^2/dz^2 - h) f = RHS(x,y,z) [which for h/=0 could also be called inhomogenous nonuniform Helmholtz equation] for the function f(x,y,z). The difference between this and poisson.f90 is that here we solve it in a non-periodic Cartesian grid, expanding the grid to curb the periodicity of the Fourier transforms.                                                                    |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``shock_finder``                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``shock_finder_comm_uu``               |                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``shock_perp``                         | This modules implements viscous heating and diffusion terms here for shock viscosity nu\_total = nu + nu\_shock*dx^2*smooth(max5(-(div u))))                                                                                                                                                                                                                                                                                                            |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``solid_cells_CGEO``                   | This module add solid (as in no-fluid) cells in the domain. This can be used e.g. in order to simulate a cylinder in a cross flow. Now, apart from the circle geometry, a 2D geometry file similar to STL can be used to represent the solid cells.Details can be found in the paper "A ghost-cell immersed boundary method for the simulations of heat transfer in compressible flows under different boundary conditions Part-II: Complex geometries" |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``solid_cells_reactive``               | This module add solid (as in no-fluid) cells in the domain. This can be used e.g. in order to simulate a cylinder in a cross flow.                                                                                                                                                                                                                                                                                                                      |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``supernova``                          | This modules contains the routines for SNe-driven ISM simulations. Still in development.                                                                                                                                                                                                                                                                                                                                                                |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``test_chemistry``                     | This modules adds chemical species and reactions. The units used in the chem.in files are cm3,mole,sec,kcal and K                                                                                                                                                                                                                                                                                                                                       |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``test_eos_chemistry``                 | Equation of state for an ideal gas without ionization.                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``test_f2003``                         | Not a module                                                                                                                                                                                                                                                                                                                                                                                                                                            |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testperturb``                        | test perturbation method                                                                                                                                                                                                                                                                                                                                                                                                                                |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``timestep_DufortFrankel``             | DuFort-Frankel time stepping routine. As is well known, this proceedure has disadvantages, but it is well suited to deal with the time step constrain near the center in spherical polar coordinates.                                                                                                                                                                                                                                                   |
+----------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

*inactive* source files (src/inactive)
--------------------------------------
The *src/inactive* directory contains 4 Fortran files.

+--------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| File                                       | Description                                                                                                                                                                                                                              |
+============================================+==========================================================================================================================================================================================================================================+
| ``deriv_3sec_insteadof_14min_compiletime`` |                                                                                                                                                                                                                                          |
+--------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``gravitational_waves_hTXk_no_xpara``      | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                   |
+--------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testfield``                              | This modules deals with all aspects of testfield fields; if no testfield fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testfield relevant subroutines listed in here. |
+--------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testfield_xz``                           | This modules deals with all aspects of testfield fields; if no testfield fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testfield relevant subroutines listed in here. |
+--------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

*initial_condition* source files (src/initial_condition)
--------------------------------------------------------
The *src/initial_condition* directory contains 67 Fortran files.

+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| File                                 | Description                                                                                                                                                                                                                                                                                                                                                                                     |
+======================================+=================================================================================================================================================================================================================================================================================================================================================================================================+
| ``1D_loop_init``                     |                                                                                                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``2d_accretion_disk``                | 21-feb-23/hongzhe: adapted from initial\_condition/centrifugal\_balance.f90                                                                                                                                                                                                                                                                                                                     |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``aerosol_init``                     | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``alfven_wave``                      | This module sets up an Alfvéén wave of amplitude init\_amp0 with wave vector init\_k0 and an optional phase init\_phase0.                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``assimilate``                       |                                                                                                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``baroclinic_init``                  |                                                                                                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``binarycomparison``                 | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``blobs_domes``                      | Initial condition (density, magnetic field, velocity) for a particular configuration of a braided magnetic field with magnetic domes with nulls.                                                                                                                                                                                                                                                |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``bonnor_ebert_sphere``              | Initial condition for a Bonnor-Ebert sphere                                                                                                                                                                                                                                                                                                                                                     |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``borromean_rings``                  | Initial condition (density, magnetic field, velocity) for a particular configuration of magnetic tubes.                                                                                                                                                                                                                                                                                         |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``braids``                           | Initial condition (density, magnetic field, velocity) for a particular configuration of a braided magnetic field.                                                                                                                                                                                                                                                                               |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``bubbles_init``                     | Initial condition for bubbles in a stratified medium. Set bubble size, bubble density, surrounding medium density, temperatures, stratification and magnetic field.                                                                                                                                                                                                                             |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``centrifugal_balance``              | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``centrifugal_balance_neutrals``     | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``cig_dynamo_benchmark``             | Set the initial conditions for the CIG Community Accuracy & Performance Benchmark: http://geodynamics.org/cig/community/workinggroups/geodyn/benchmark/ following Christensen et al. Physics of the Earth and Planetary Interiors, 128, 25-34 (2001).                                                                                                                                           |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``circumplanetary``                  | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``coronae_init``                     |                                                                                                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``cylindrical_energy``               | Initial condition (density, magnetic field, velocity) for magnetohydrostatical equilibrium in a global accretion disk in a cylindrically symmetric  profile in spherical coordinates. with a polytropic equation of state including entropy equation                                                                                                                                            |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``disk+corona``                      | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``dust-equilibrium``                 | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``fieldloop``                        | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``fluxring_cylindrical``             | Initial condition (density, magnetic field, velocity) for magnetohydrostatical equilibrium in a global accretion disk with an imposed (cylindrically symmetric) sound speed profile in spherical coordinates.                                                                                                                                                                                   |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``fluxrings``                        | Magnetic flux rings. Constructed from a canonical ring which is the rotated and translated; see Pencil Code manual, Section C.3.                                                                                                                                                                                                                                                                |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``hill_vortex``                      | Initial condition (density, magnetic field, velocity) for magnetohydrostatical equilibrium in a global accretion disk with an imposed (cylindrically symmetric) sound speed profile in spherical coordinates.                                                                                                                                                                                   |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``hor-fluxlayer-By``                 | Horizontal flux layer in B\_y, with tanh profiles switching on (off) at z0 (z1) Density and entropy also set appropriately. To reproduce initial condition in Catteneo & Hughes, JFM, v. 196, p. 323, 1988                                                                                                                                                                                      |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``hs_equilibrium_ism``               | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``hydrostat-pload``                  |                                                                                                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``ice_shell``                        | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``import``                           | Initial condition (density, magnetic field, velocity) for a field created externally in pencil code format. The file must be in an appropriate format with the right order of indices and match with start.in. USE WITH CAUTION!                                                                                                                                                                |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``import_glemur``                    | Initial condition (density, magnetic field, velocity) for a field from the code GLEMuR.                                                                                                                                                                                                                                                                                                         |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``iucaa_logo``                       | Initial condition (density, magnetic field, velocity) for a particular configuration of a magnetic tube.                                                                                                                                                                                                                                                                                        |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``kelvin_helmholtz``                 | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``kelvin_helmholtz_Lecoanet_etal16`` | Kelvin-Helmholtz initial condition from Lecoanet et al. (2016, MNRAS 455, 4274)                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``linked_tori_twisted``              | Initial condition (density, magnetic field, velocity) for a particular configuration of magnetic tubes.                                                                                                                                                                                                                                                                                         |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``magnetic_carpet``                  | Initial condition (density, magnetic field, velocity) for a particular configuration of magnetic carpets.                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``mhs_equilibrium``                  | Initial condition (density, magnetic field, velocity) for magnetohydrostatical equilibrium in a global accretion disk with an imposed (cylindrically symmetric) sound speed profile in spherical coordinates.                                                                                                                                                                                   |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``MRI_2D_Test``                      | Initial condition (density, magnetic field, velocity) for magnetohydrostatical equilibrium in a global accretion disk with an imposed (cylindrically symmetric) sound speed profile in spherical coordinates.                                                                                                                                                                                   |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``mri_cycle``                        | Initial condition (magnetic field, velocity) for the MRI cycle described in                                                                                                                                                                                                                                                                                                                     |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``mri_nonlinear``                    | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``multi_rings``                      | Initial condition (density, magnetic field, velocity) for a particular configuration of magnetic tubes.                                                                                                                                                                                                                                                                                         |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nfoil``                            | Initial condition (density, magnetic field, velocity) for a particular configuration of a magnetic tube.                                                                                                                                                                                                                                                                                        |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``novertical_shear``                 | Initial condition for run without vertical shear using the (unphysical) modified gravity profile of Klahr et al. (2023)                                                                                                                                                                                                                                                                         |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Orszag_Tang_Vortex``               | Initial condition (density, magnetic field, velocity) for magnetohydrostatical equilibrium in a global accretion disk with an imposed (cylindrically symmetric) sound speed profile in spherical coordinates.                                                                                                                                                                                   |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``parker_wind``                      | Initial condition for the parker wind in spherical coordinates.                                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``pressure_bump_global``             | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``random_helical``                   |                                                                                                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Rayleigh-Taylor``                  |                                                                                                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``reflect``                          |                                                                                                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``rti``                              |                                                                                                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``shallow_water_init``               |                                                                                                                                                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``shock_cloud``                      | Shock-Cloud Initial Condition sets up a 2D version similar to The Magnetohydrodynamics of Shock-Cloud Interaction in Three Dimensions Min-Su Shin, James M Stone, and Gregory F Snyder http://adsabs.harvard.edu/cgi-bin/nph-data\_query?bibcode=2008ApJ...680..336S&link\_type=ABSTRACT                                                                                                        |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``shocktube``                        | This module provide a way for users to specify custom initial conditions.                                                                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``solar_atmosphere_Omega_bfield``    | Initial condition for a stably tratified solar atmosphere from the convection zone to the corona, with a Omega shaped magnetic field loop.                                                                                                                                                                                                                                                      |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``spherical_convection``             | Isentropic initial condition (density, entropy) for convection in spherical coordinates. Produces an isentropic stratification with given surface gravity and surface temperature, and a heat conduction profile proportional to r^-15. The setup was originally introduced in Astron. Nachr., 332, 883.                                                                                        |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``star_box_layers``                  | 31-oct-2011/dintrans: coded (moved here my two subroutines from the entropy module after discussions during the 2011 PC meeting in Toulouse). This module initializes the star-in-a-box setup with a central heating.                                                                                                                                                                           |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``star_in_a_box_poly``               | Piecewise polytopic initial condition for star-in-a-box models                                                                                                                                                                                                                                                                                                                                  |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``streaming_instability``            | This module sets up nonlinear streaming instability with multiple particle species.                                                                                                                                                                                                                                                                                                             |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``tabulated``                        | This module loads an existing snapshot and interpolates it to the current grid as the initial condition.  The snapshot should be saved as a global snapshot in a single file (default name: tabulated.dat) under the run directory.  The user should specify its dimensions using nxtab, nytab, and nztab. The number of variables in the snapshot must be consistent with the current mfarray. |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``ths1D_equilibrium_ism``            | This module provides a 1D profile of density and temperature for the initial conditions to be applied for supernova driven turbulence simulations in the interstellar medium. After the 1D profile converges to an equilibrium state save the profiles of rho and tt to init\_ism.dat, which will be imported by initial\_condition/ths\_equilibrium\_ism.f90 for 3D simulations                |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``ths_equilibrium_ism``              | Initial conditions for 3D equilibrium supernova driven turbulence simulations. First run 1D simulation using identical z grid with initial\_condition/ths1D\_equilibrium\_ism.f90. This module will load the converged 1D profiles derived and saved to init\_ism.dat (now init\_ism.in).                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``trefoil``                          | Initial condition (density, magnetic field, velocity) for a particular configuration of magnetic flux rings.                                                                                                                                                                                                                                                                                    |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``twisted_tubes``                    | Initial condition (density, magnetic field, velocity) for a particular configuration of a twsited magnetic field tube(s).                                                                                                                                                                                                                                                                       |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``twistedtiltedtoros``               | 17-jul-12/piyali: adapted from fluxrings.f90 but for spherical geometry. Also some major changes, hence a new initial condition                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``viscous_ring``                     | Initial condition for spherical viscous ring, according to the test of Frederic Masset,                                                                                                                                                                                                                                                                                                         |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``vortex_braids``                    | Initial condition (density, magnetic field, velocity) for a particular configuration of a braided vortex field.                                                                                                                                                                                                                                                                                 |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``wave_Bx``                          | Initial condition for sin(kz) or cos(kz) magnetic field.                                                                                                                                                                                                                                                                                                                                        |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``whitehead_link``                   | Initial condition (density, magnetic field, velocity) for a particular configuration of magnetic tubes.                                                                                                                                                                                                                                                                                         |
+--------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

*magnetic* source files (src/magnetic)
--------------------------------------
The *src/magnetic* directory contains 5 Fortran files.

+------------------------+------------------------------------------------------------------------------------------------------------------------+
| File                   | Description                                                                                                            |
+========================+========================================================================================================================+
| ``maxwell``            | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc. |
+------------------------+------------------------------------------------------------------------------------------------------------------------+
| ``meanfield``          | This modules solves mean-field contributions to both the induction and the momentum equations.                         |
+------------------------+------------------------------------------------------------------------------------------------------------------------+
| ``meanfield_demfdt``   | This modules solves mean-field contributions to both the induction and the momentum equations.                         |
+------------------------+------------------------------------------------------------------------------------------------------------------------+
| ``nomeanfield``        | This modules solves mean-field contributions to both the induction and the momentum equations.                         |
+------------------------+------------------------------------------------------------------------------------------------------------------------+
| ``nomeanfield_demfdt`` | Dummy module for mean-field contributions                                                                              |
+------------------------+------------------------------------------------------------------------------------------------------------------------+

*obsolete* source files (src/obsolete)
--------------------------------------
The *src/obsolete* directory contains 16 Fortran files.

+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| File                       | Description                                                                                                                                                                                                                                                                                 |
+============================+=============================================================================================================================================================================================================================================================================================+
| ``density_anelastic``      | This module takes care of the continuity equation.                                                                                                                                                                                                                                          |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``global_gg_bext``         | A module container and access functions ('methods') for additional variables which are globally needed --- here this is the gravity field gg, and an external magnetic field (such that B=curl(A)+B\_ext\_pot)                                                                              |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``localshock``             | This module fetchs the position of the massive n-body particles and applies extra shock dissipation around them. This allows for less shock dissipation to be used elsewhere in the quiescent regions of the simulation box.                                                                |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``magnetic_axisym``        | This modules deals with all aspects of magnetic fields; if no magnetic fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the magnetically relevant subroutines listed in here.                                                   |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``magnetic_old``           | This modules deals with all aspects of magnetic fields; if no magnetic fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the magnetically relevant subroutines listed in here.                                                   |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nohydro_file``           |                                                                                                                                                                                                                                                                                             |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``nosyscalls``             | This module takes care of system calls and provides ANSI-C functionality.                                                                                                                                                                                                                   |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``particles_nbody``        | This module takes care of direct N-body gravity between particles.                                                                                                                                                                                                                          |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``radiation_fld``          | Radiation in the fluxlimited-diffusion approximation. Doesn't work convincingly (and maybe never will). Look at the (still experimental) module radiation\_ray.f90 for a more sophisticated approach.                                                                                       |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``radiation_nongrey``      |                                                                                                                                                                                                                                                                                             |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``radiation_ray_periodic`` | Radiation (solves transfer equation along rays) The direction of the ray is given by the vector (lrad,mrad,nrad), and the parameters radx0,rady0,radz0 gives the maximum number of steps of the direction vector in the corresponding direction.                                            |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``temperature``            | This module replaces the entropy module by using lnT as dependent variable. For a perfect gas with constant coefficients (no ionization) we have (1-1/gamma) * cp*T = cs02 * exp( (gamma-1)*ln(rho/rho0)-gamma*s/cp ) At a later point we may want to rename the module Entropy into Energy |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``temperature_TT``         | This module can replace the entropy module by using \_T\_ as dependent variable. For a perfect gas with constant coefficients (no ionization) we have (1-1/gamma) * cp*T = cs02 * exp( (gamma-1)*ln(rho/rho0)-gamma*s/cp )                                                                  |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``visc_hyper``             | This modules implements viscous heating and diffusion terms here for third order hyper viscosity                                                                                                                                                                                            |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``visc_smagorinsky``       | This modules implements viscous heating and diffusion terms here smagorinsky viscosity                                                                                                                                                                                                      |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``visc_var``               | This modules implements viscous heating and diffusion terms here for cases 1) nu constant, 2) mu = rho.nu 3) constant and                                                                                                                                                                   |
+----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

*pre_and_post_processing* source files (src/pre_and_post_processing)
--------------------------------------------------------------------
The *src/pre_and_post_processing* directory contains 11 Fortran files.

+-----------------------+---------------+
| File                  | Description   |
+=======================+===============+
| ``pc_collect``        | Not a module  |
+-----------------------+---------------+
| ``pc_collect_exp``    | Not a module  |
+-----------------------+---------------+
| ``pc_collect_pvar``   | Not a module  |
+-----------------------+---------------+
| ``pc_configtest``     | Not a module  |
+-----------------------+---------------+
| ``pc_distribute``     | Not a module  |
+-----------------------+---------------+
| ``pc_distribute_z``   | Not a module  |
+-----------------------+---------------+
| ``pc_extract``        | Not a module  |
+-----------------------+---------------+
| ``pc_reduce``         | Not a module  |
+-----------------------+---------------+
| ``pc_tecplot``        | Not a module  |
+-----------------------+---------------+
| ``pc_tecplot_solid``  | Not a module  |
+-----------------------+---------------+
| ``read_xyaver_alpha`` | Not a module  |
+-----------------------+---------------+

*special* source files (src/special)
------------------------------------
The *src/special* directory contains 69 Fortran files.

+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| File                             | Description                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+==================================+=================================================================================================================================================================================================================================================================================================================================================================================================================================================+
| ``1D_loop``                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``advective_gauge``              | Advecto-resistive gauge, dLam/dt = -u.gradLambda - U.A\_resistive + eta*del2A\_resistive A\_advecto-resistive=A\_resistive+grad Lambda                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``alphadisk``                    | This module solves for a viscously diffusive disk according to the alpha-formalism, also adding photoevaporation. It is a one-dimensional evolutionary model, that evolves the disk over its multimillion year lifetime.                                                                                                                                                                                                                        |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``ascale_collapse``              | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``atmosphere``                   | This module incorporates all the modules used for Natalia's aerosol simulations                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``axionSU2back``                 | Solve the lucky droplet model for many realizations. The different realizations correspond to "meshpoints". To add the contributions for each step, we use the usual time step in the Pencil Code, so t is just the step, and the accumulated collision times (after 125 steps or so) for all realizations at the same time are the values in the f-array.                                                                                      |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``backreact_infl``               | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``baroclinic_run``               |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``bc_strat``                     | This module sets the open boundary conditions for density in the vertical direction, scaled by stratificaiton.                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``beta_plane``                   | Add Coriolis force in the beta plane approximation to the hydro equation. The x-axis is in the direction of increasing colatitude, while the z-axis is the radial direction.                                                                                                                                                                                                                                                                    |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``boussinesq``                   | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``chem_stream``                  | This module incorporates all the modules used for Natalia's neutron star -- disk coupling simulations (referred to as nstar)                                                                                                                                                                                                                                                                                                                    |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``chiral_mhd``                   | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``collapse``                     | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``coronae``                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``dampuu``                       | Special module that damps the velocity field outside a user-specified cuboid. Useful in cases where you do not want waves reflected from the boundary to interfere with the interior of the domain.                                                                                                                                                                                                                                             |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``disp_current``                 | Electric field, dE/dt = curlB, originally only for the special case of no fluid induction, but now fluid motions are also included.                                                                                                                                                                                                                                                                                                             |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``dynamical_resistivity``        |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``electroweaksu2``               | Dynamical equations for electroweak SU(2) non-Abelian gauge fields                                                                                                                                                                                                                                                                                                                                                                              |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``flowaroundsphere``             | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``flux_limdiff``                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``footpoints``                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``gravitational_waves``          | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``gravitational_waves_hij6``     | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``gravitational_waves_hTXk``     | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``gross_pitaevskii``             | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``internal_flow``                |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``jet``                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``klein_gordon``                 | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Lambda_CDM``                   | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``lorenz_gauge``                 | Lorenz gauge, dphi/dt = -cphi2*divA                                                                                                                                                                                                                                                                                                                                                                                                             |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``lucky_droplet``                | Solve the lucky droplet model for many realizations. The different realizations correspond to "meshpoints". To add the contributions for each step, we use the usual time step in the Pencil Code, so t is just the step, and the accumulated collision times (after 125 steps or so) for all realizations at the same time are the values in the f-array.                                                                                      |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``magneticspiral``               |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``meanfield_alpm``               | This module serves as a sample for a special\_XXX module that introduces additional primitive variables. Use this as a basis for your own special\_ module if you need one.                                                                                                                                                                                                                                                                     |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``meanfield_alpm_alternate``     | This module serves as a sample for a special\_XXX module that introduces additional primitive variables. Use this as a basis for your own special\_ module if you need one.                                                                                                                                                                                                                                                                     |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``meanfield_alpm_etat``          | This module serves as a sample for a special\_XXX module that introduces additional primitive variables. Use this as a basis for your own special\_ module if you need one.                                                                                                                                                                                                                                                                     |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``meanfield_dynamo_z``           | Mean field dynamo equation                                                                                                                                                                                                                                                                                                                                                                                                                      |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``meanfield_e_tensor``           | This special module will contribute a mean electromotive force to the vector potential differential equation.                                                                                                                                                                                                                                                                                                                                   |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``multisp_drag_eq``              | This module handles diagnostics that are related with dust-gas velocities in drag equilibrium, computed by initial\_condition/streaming\_instability.f90.                                                                                                                                                                                                                                                                                       |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``neutron_star``                 | This module incorporates all the modules used for Natalia's neutron star -- disk coupling simulations (referred to as nstar)                                                                                                                                                                                                                                                                                                                    |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``newton_cooling``               |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``NS_polecap``                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``oscillation_0D``               | Solve for a set of two ODEs, used to test time step                                                                                                                                                                                                                                                                                                                                                                                             |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``oscillation_0D_Lorenz``        | Solve for a set of two ODEs, used to test time step                                                                                                                                                                                                                                                                                                                                                                                             |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``oscillation_3D``               | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``param_instab``                 | Parametric instability with a time-dependent forcing                                                                                                                                                                                                                                                                                                                                                                                            |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``photoelectric_dust``           |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``planet_atmosphere``            | This module includes physics related to planet atmospheres.                                                                                                                                                                                                                                                                                                                                                                                     |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``pressure_bump``                | Thie module addes pressure bumps to your simulations. They are needed e.g. when simulating the effects of a pressure bump on particle drift, particle trapping and planetesimal formation via gravitational fragmentation.                                                                                                                                                                                                                      |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``radial_dist_func``             | Calculate the radial distribution function based on a pre-generated input file. This input file is generated by first reading the stored data into IDL by the routine: f90/pencil-christer/isoth\_expwave/idl/pvar.pro then the input file is generated with an adapted version of the following routine: f90/pencil-christer/isoth\_expwave/idl/rnp256.pro Finally you can then run start.csh with something like the following start.in file: |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``reaction_0D``                  | Solve for a set of two ODEs, used to test time step                                                                                                                                                                                                                                                                                                                                                                                             |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``rel_1d``                       | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``rtime_phiavg``                 | This module calculates a number of outputs and removes a mean (phi-averaged) emf from the simulations with net vertical fields on global accretion disks                                                                                                                                                                                                                                                                                        |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``set_gravity``                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``shallow_water``                |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``shell``                        | Runs a shell model (only GOY implemented) for turbulence Copied from Dhruba's code Uses a slaved, Adams-Bashforth scheme run in parallel with the PC time stepping                                                                                                                                                                                                                                                                              |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``solar_corona``                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``spiegel``                      | This module is currently fairly much obsolete. This module incorporates all the modules used for Natalia's neutron star -- disk coupling simulations (referred to as nstar)                                                                                                                                                                                                                                                                     |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``stellartide``                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``streamfunction``               | This module solves for a streamfunction for the 2D velocity field.                                                                                                                                                                                                                                                                                                                                                                              |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``streamfunction_dimensional``   | This module solves for a streamfunction for the 2D velocity field.                                                                                                                                                                                                                                                                                                                                                                              |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``streamfunction_direct``        | This module solves for a streamfunction for the 2D velocity field.                                                                                                                                                                                                                                                                                                                                                                              |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``streamfunction_fullmultigrid`` | This module solves for a streamfunction for the 2D velocity field.                                                                                                                                                                                                                                                                                                                                                                              |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``streamfunction_multigrid``     | This module solves for a streamfunction for the 2D velocity field.                                                                                                                                                                                                                                                                                                                                                                              |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``symbreak``                     | Solve for a set of two ODEs, used to test time step                                                                                                                                                                                                                                                                                                                                                                                             |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``turbpotential``                |                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``twist_inject``                 | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``twist_inject_delta``           | This module provide a way for users to specify custom (i.e. not in the standard Pencil Code) physics, diagnostics etc.                                                                                                                                                                                                                                                                                                                          |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``van_der_pol``                  | Solve the Van der Pol oscillator equations                                                                                                                                                                                                                                                                                                                                                                                                      |
+----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

*test_methods* source files (src/test_methods)
----------------------------------------------
The *src/test_methods* directory contains 11 Fortran files.

+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| File                     | Description                                                                                                                                                                                                                                       |
+==========================+===================================================================================================================================================================================================================================================+
| ``testfield_axisym4``    | Test-field module for axisymmetric turbulence. No special settings in cparam.local are needed.                                                                                                                                                    |
+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testfield_compress_z`` | This modules deals with all aspects of testfield fields; if no testfield fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testfield relevant subroutines listed in here.          |
+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testfield_general``    |                                                                                                                                                                                                                                                   |
+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testfield_nonlin_z``   | This modules deals with all aspects of testfield fields; if no testfield fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testfield relevant subroutines listed in here.          |
+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testfield_x``          | This modules deals with all aspects of testfield fields; if no testfield fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testfield relevant subroutines listed in here.          |
+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testfield_xy``         | This modules deals with all aspects of testfield fields; if no testfield fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testfield relevant subroutines listed in here.          |
+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testfield_xz``         | This modules deals with all aspects of testfield fields; if no testfield fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testfield relevant subroutines listed in here.          |
+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testfield_z``          | This modules deals with all aspects of testfield fields; if no testfield fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testfield relevant subroutines listed in here.          |
+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testscalar``           | This modules deals with all aspects of testscalar fields; if no testscalar fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testscalar relevant subroutines listed in here.       |
+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testscalar_axisym``    | This modules deals with testscalar fields for axisymmetric turbulence testscalar fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testscalar relevant subroutines listed in here. |
+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``testscalar_simple``    | This modules deals with all aspects of testscalar fields; if no testscalar fields are invoked, a corresponding replacement dummy routine is used instead which absorbs all the calls to the testscalar relevant subroutines listed in here.       |
+--------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

